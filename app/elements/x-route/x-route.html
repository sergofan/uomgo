<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="x-route">
	<template>
		<style>
			:host {
				display: block;
			}
		</style>

		<firebase-auth id="auth"
									 user="{{user}}"
									 provider="google"
									 app-name="uomgo"
									 on-error="showError"></firebase-auth>

		<global-variable key="route" value="{{route}}"></global-variable>
		<global-variable key="appRouteData" value="{{appRouteDataPage}}"></global-variable>
		<global-variable key="appRouteSubdata" value="{{appRouteSubdataPage}}"></global-variable>

		<app-location route="{{route}}" use-hash-as-path></app-location>

		<app-route route="{{route}}"
									pattern="/:page"
									data="{{appRouteData}}"
									tail="{{_tail}}"></app-route>

		<app-route route="{{_tail}}"
							 pattern="/:page"
							 data="{{appRouteSubdata}}"></app-route>
	</template>
	<script>
	(function() {
		'use strict';

		Polymer({
			is: 'x-route',
			properties: {
				route: {
					type: Object,
					// notify: true,
					observer: '_routeChanged'
				},
				appRouteData: {
					type: Object,
					// notify: true,
					observer: '_routeDataChanged'
				},
				appRouteSubdata: {
					type: Object,
					// notify: true,
					observer: '_routeSubataChanged'
				},
				appRouteDataPage: {
					observer: '_routeDataPageChanged'
				},
				appRouteSubdataPage: {
					observer: '_routeSubataPageChanged'
				},
				_tail: {
					type: Object
				},
			},
			ready: function() {
				// this.async(function() {
        //   if (this.route.path === "") {
        //     this.set('route.path', '/main');
        //   }
				// });
				// this.appRouteData.page = 'about';
			},
			_routeChanged: function(newValue, oldValue) {
				// if (this.route && this.appRouteData && this.appRouteSubdata) {
				//	console.log(newValue.path);
				// }

				// this.async(function() {
				// 	switch(newValue.path) {
				// 		case '':
				// 			this.set('newValue.path', '/main');
				// 			break;
				// 		// case '/':
				// 		// 	this.set('newValue.path', '/main');
				// 		// 	break;
				// 		case '/about':
				// 			this.set('newValue.path', '/about/boss');
				// 			break;
				// 		case '/virt':
				// 			if (user) {
				// 				this.set('newValue.path', '/virt/messages');
				// 			} else {
				// 				this.set('newValue.path', '/virt/rules');
				// 			};
				// 			break;
				// 	}
				// });
			},
			_routeDataChanged: function(newValue, oldValue) {
				console.log(newValue);
			},
			_routeSubataChanged: function(newValue, oldValue) {
				// console.log(newValue.page);
			},
			_routeDataPageChanged: function(newValue, oldValue) {
				console.log(oldValue, newValue);
				// this.set('appRouteData.page', newValue);
				this.appRouteData.page = newValue;
			},
			_routeSubataPageChanged: function(newValue, oldValue) {
				// console.log(newValue);
				// this.set('appRouteSubdata.page', newValue);
			}
		});
	})();
	</script>
</dom-module>
