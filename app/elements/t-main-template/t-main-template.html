<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="t-main-template">
	<template>
		<style is="custom-style" include="shared-styles">
			:host {
				display: block;
				word-wrap: break-word;
			}
			.yellow-button {
				text-transform: none;
				color: #eeff41;
			}
			#toastMessage {
				--paper-toast-background-color: #01579B;
				--paper-toast-color: white;
				/*position: initial !important;*/
				/*width: 100%;*/
				margin: 16px 0;
				border-radius: 8px;
				border: 1px solid #ddd;
				box-shadow: 0 8px 10px 1px rgba(0, 0, 0, 0.14), 0 3px 14px 2px rgba(0, 0, 0, 0.12), 0 5px 5px -3px rgba(0, 0, 0, 0.4);
				transform: rotate(90deg);
				transform-origin: left top 0;
			}
			#toastMessageContainer {
				background-color: #00E676;
				/*color: white;*/
				position: fixed;
				/*right: -162px;*/
				top: calc(50vh - 68px);
				right: -178px;
				width: 200px;
				height: 134px;
				/*padding: 4px 16px;*/
				border-radius: 8px 0 0 8px;
				border: 1px solid #ddd;
				box-shadow: 0 8px 10px 1px rgba(0, 0, 0, 0.14), 0 3px 14px 2px rgba(0, 0, 0, 0.12), 0 5px 5px -3px rgba(0, 0, 0, 0.4);
				font-weight: 500;
				-webkit-transition: right 0.5s;
				transition: right 0.5s;
				cursor: pointer;
				z-index: 1001;
			}
			#toastMessageContainer:hover {
				right: 0px;
			}
			#verticalText {
				position: absolute;
				height: 100%;
				width: 134px;
				margin: 4px;
				transform: rotate(-90deg);
				align-self: center;
				text-align: center;
			}
		</style>

		<div id="toastMessageContainer" class="layout horizontal">
			<div id="verticalText">
				План работы УОМГО
			</div>

			<div class="content layout vertical center-center">
				<paper-button raised style="margin-left: 32px; text-align: center;">
					<a href="#/about/docs" style="text-decoration: none; color: black;">Перейти в раздел документы</a><iron-icon icon="arrow-forward">
				</iron-icon></paper-button>
<!-- 			
				<p><a href="#">Lorem ipsum</a></p>
				<p>hgfd gfds gfdss</p>
 -->		
			</div>

		</div>

<!-- 
		<paper-toast id="toastMessage"
								 auto-fit-on-attach
								 dynamic-align
								 horizontal-align="right"
								 vertical-align="bottom"
								 duration="0"
								 text="Недельный план работы УО МГО">
			<paper-button on-tap="closeToast" class="yellow-button">Закрыть!</paper-button>
		</paper-toast>
 -->
		<firebase-document id="firebaseDocument"
											 app-name="uomgo"></firebase-document>

		<x-messages></x-messages>
		<x-posts limit-to-first="[[limitToFirst]]"
						 limit-to-last="[[limitToLast]]"
						 start-at="[[startAt]]"
						 end-at="[[endAt]]"
						 user="[[user]]"></x-posts>

		<template is="dom-if" if="[[user]]">
			<paper-fab id="add"
								 icon="add"
								 mini="true"
								 class="green"
								 style="position:fixed;bottom:48px;right:16px;"></paper-fab>
		</template>

		<x-post-edit-dialog></x-post-edit-dialog>

	</template>
	<script>
	(function() {
		'use strict';

		Polymer({
			is: 't-main-template',
			properties: {
				limitToLast: {
					type: Number,
					notify: true,
				},
				limitToFirst: {
					type: Number,
					notify: true,
				},
				startAt: {
					type: String,
					notify: true
				},
				endAt: {
					type: String,
					notify: true,
				},
				dataDB: {
					type: Object,
					observer: 'dataChanged',
					notify: true
				},
				postData: {
					type: Object,
					value: {}
				},
				key: {
					type: String,
					value: ''
				},
				user: {
					type: Object
				}
			},
			ready: function() {
				var firebaseDocument = this.$.firebaseDocument;
				// var toastMessage = this.$.toastMessage;
				// toastMessage.fitInto = this.$.toastMessageContainer;
				// setTimeout(function() {
					// this.openToast();
				// }.bind(this), 2500);

			},
			editPostDialogOpen: function(e) {
				this.postData = {};
				if (e.model !== undefined) {
					this.postData = Object.assign({}, e.model.post);
				};
				editPostDialog.toggle();
			},
			deletePostDialogOpen: function(e) {
				this.postData = {};
				if (e.model !== undefined) {
					this.postData = Object.assign({}, e.model.post);
				};
				deletePostDialog.toggle();
			},
			_savePost: function() {
				delete firebaseDocument.data;
				if ( this.postData['name'] !== undefined ) {
					firebaseDocument.data['name'] = this.postData['name'];
				};
				if ( this.postData['video-id'] !== undefined ) {
					firebaseDocument.data['video-id'] = this.postData['video-id'];
				};
				if ( this.postData['text'] !== undefined ) {
					firebaseDocument.data['text'] = this.postData['text'];
				};
				if ( this.postData['date'] !== undefined ) {
					firebaseDocument.data['date'] = this.postData['date'];
				};
				if (this.postData.$key !== undefined) {
					firebaseDocument.save("/posts", this.postData.$key);
				} else firebaseDocument.save("/posts");
			},
			_deletePost: function() {
				var key = this.postData.$key;
				firebaseDocument.data = Object.assign({}, null);
				firebaseDocument.save("/posts", key);
			},
			_computePath: function(key) {
				return "/posts/" + key;
			}
			// openToast: function(event) {
				// toastMessage.open();
			// },
			// closeToast: function(event) {
				// toastMessage.close();
			// }
		});

	})();
	</script>
</dom-module>
